# ğŸ¨ Customer Support Chat System - Visual Overview

## ğŸ–¼ï¸ What You'll See

### 1. CHAT WIDGET (Customer View)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸŸ¢ Chat                        âœ•   â”‚ â† Header (Teal #008B8B)
â”‚  ğŸ‘¤ rokomari                        â”‚ â† Agent Name
â”‚  â— Support is online                â”‚ â† Status
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚ â† Agent Message
â”‚  â”‚ à¦†à¦¸à¦¸à¦¾à¦²à¦¾à¦®à§ à¦†à¦²à¦¾à¦‡à¦•à§à¦®,  â”‚           â”‚   (White Bubble)
â”‚  â”‚ à¦°à¦•à¦®à¦¾à¦°à¦¿ à¦‰à¦Ÿà¦•à¦¸à§‡ à¦¸     â”‚           â”‚
â”‚  â”‚ à¦†à¦ªà¦¨à¦¾à¦•à§‡ à¦¸à§à¦¬à¦¾à¦—à¦¤à¦®à¥¤    â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                     â”‚
â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â† User Message
â”‚            â”‚ I need help with   â”‚  â”‚   (Teal Bubble)
â”‚            â”‚ my order          â”‚  â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [Compose message...]  ğŸ˜Š ğŸ“ â¤      â”‚ â† Input Area
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“ Minimized:
  [ğŸ’¬ 2]  â† Floating Button
```

### 2. ADMIN PANEL (Agent View)

```
CONVERSATIONS LIST
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ID          User        Status    Priority  Unread     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ CONV-ABC    John Doe    [Open]    [High]    3         â”‚
â”‚ CONV-XYZ    Jane Smith  [Pending] [Normal]  1         â”‚
â”‚ CONV-123    Ali Khan    [Resolved][Low]     0         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

CONVERSATION DETAIL
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CONV-ABC123 | Assigned: rokomari | Status: Open       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Customer: I need help with my order                    â”‚
â”‚ Agent: Hello! I'd be happy to help. What's your        â”‚
â”‚        order number?                                    â”‚
â”‚ Customer: ORDER-12345                                   â”‚
â”‚ [Reply message inline...]                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

CHAT SETTINGS
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â˜‘ Enable Chat Widget                                   â”‚
â”‚ Widget Position: [Bottom Right â–¼]                      â”‚
â”‚ Primary Color: [#008B8B] (Color Picker)               â”‚
â”‚ Welcome Message: [Hello! How can we help...]          â”‚
â”‚ Welcome Message BN: [à¦†à¦¸à¦¸à¦¾à¦²à¦¾à¦®à§ à¦†à¦²à¦¾à¦‡à¦•à§à¦®...]             â”‚
â”‚ Max File Size: [5] MB                                  â”‚
â”‚ â˜‘ Auto Assign to Agent                                 â”‚
â”‚ â˜‘ Show Online Status                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“‚ File Structure Created

```
BookShop/
â”‚
â”œâ”€â”€ support/                          # NEW APP
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ admin.py                     # âœ… Admin interface
â”‚   â”œâ”€â”€ apps.py
â”‚   â”œâ”€â”€ models.py                    # âœ… 5 Models
â”‚   â”œâ”€â”€ views.py                     # âœ… 9 Views
â”‚   â”œâ”€â”€ urls.py                      # âœ… URL routing
â”‚   â”œâ”€â”€ tests.py
â”‚   â””â”€â”€ migrations/
â”‚       â””â”€â”€ 0001_initial.py          # âœ… Database tables
â”‚
â”œâ”€â”€ static/
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â””â”€â”€ chat-widget.css          # âœ… 350+ lines
â”‚   â””â”€â”€ js/
â”‚       â””â”€â”€ chat-widget.js           # âœ… 500+ lines
â”‚
â”œâ”€â”€ templates/
â”‚   â”œâ”€â”€ base.html                    # âœ… Updated
â”‚   â””â”€â”€ support/                     # âœ… NEW
â”‚       â”œâ”€â”€ my_conversations.html    # âœ… List view
â”‚       â””â”€â”€ conversation_detail.html # âœ… Detail view
â”‚
â”œâ”€â”€ media/
â”‚   â””â”€â”€ support/                     # âœ… NEW
â”‚       â”œâ”€â”€ agents/                  # Agent avatars
â”‚       â””â”€â”€ attachments/             # File uploads
â”‚
â”œâ”€â”€ SUPPORT_CHAT_SYSTEM_GUIDE.md        # âœ… Full docs
â”œâ”€â”€ SUPPORT_CHAT_QUICK_START.md         # âœ… Quick ref
â”œâ”€â”€ SUPPORT_CHAT_INSTALLATION_COMPLETE.md # âœ… Summary
â””â”€â”€ setup_support.py                    # âœ… Setup script
```

## ğŸ—„ï¸ Database Schema

```sql
-- 5 New Tables Created

support_supportagent
â”œâ”€â”€ id (PK)
â”œâ”€â”€ user_id (FK â†’ accounts_user)
â”œâ”€â”€ display_name
â”œâ”€â”€ display_name_bn
â”œâ”€â”€ avatar
â”œâ”€â”€ is_online âš¡
â”œâ”€â”€ bio
â”œâ”€â”€ email
â”œâ”€â”€ is_active
â”œâ”€â”€ order
â””â”€â”€ created_at

support_conversation
â”œâ”€â”€ id (PK)
â”œâ”€â”€ conversation_id (Unique)
â”œâ”€â”€ user_id (FK â†’ accounts_user)
â”œâ”€â”€ assigned_agent_id (FK â†’ support_supportagent)
â”œâ”€â”€ subject
â”œâ”€â”€ status (open/pending/resolved/closed)
â”œâ”€â”€ priority (low/normal/high/urgent)
â”œâ”€â”€ language (en/bn)
â”œâ”€â”€ user_unread_count
â”œâ”€â”€ agent_unread_count
â”œâ”€â”€ last_message_at
â”œâ”€â”€ created_at
â””â”€â”€ updated_at

support_message
â”œâ”€â”€ id (PK)
â”œâ”€â”€ conversation_id (FK â†’ support_conversation)
â”œâ”€â”€ sender_id (FK â†’ accounts_user)
â”œâ”€â”€ is_agent
â”œâ”€â”€ message_type (text/image/file/system)
â”œâ”€â”€ content
â”œâ”€â”€ attachment
â”œâ”€â”€ attachment_name
â”œâ”€â”€ is_read
â”œâ”€â”€ read_at
â”œâ”€â”€ created_at
â””â”€â”€ edited_at

support_quickreply
â”œâ”€â”€ id (PK)
â”œâ”€â”€ title
â”œâ”€â”€ title_bn
â”œâ”€â”€ content
â”œâ”€â”€ content_bn
â”œâ”€â”€ category
â”œâ”€â”€ is_active
â”œâ”€â”€ order
â””â”€â”€ created_at

support_chatsettings (Singleton)
â”œâ”€â”€ id (PK = 1)
â”œâ”€â”€ is_enabled
â”œâ”€â”€ welcome_message
â”œâ”€â”€ welcome_message_bn
â”œâ”€â”€ offline_message
â”œâ”€â”€ offline_message_bn
â”œâ”€â”€ widget_position
â”œâ”€â”€ primary_color
â”œâ”€â”€ auto_assign
â”œâ”€â”€ max_file_size
â”œâ”€â”€ business_hours_start
â”œâ”€â”€ business_hours_end
â”œâ”€â”€ show_online_status
â”œâ”€â”€ created_at
â””â”€â”€ updated_at
```

## ğŸ”„ Data Flow

### Customer Sends Message:
```
Customer Types
    â†“
JavaScript captures
    â†“
AJAX POST to /support/api/conversation/{id}/send/
    â†“
Django View validates
    â†“
Creates Message object
    â†“
Updates Conversation
    â†“
Returns JSON response
    â†“
JavaScript updates UI
    â†“
Message appears in chat
```

### Polling for New Messages:
```
Every 3 seconds:
    â†“
JavaScript makes GET request
    â†“
/support/api/conversation/{id}/messages/
    â†“
Django returns messages after last_message_id
    â†“
JavaScript checks for new messages
    â†“
If new messages found:
    â†“
Append to chat
    â†“
Update unread badge
    â†“
Play notification sound
```

### Agent Sees Conversation:
```
Admin Panel
    â†“
Conversations List
    â†“
Filter/Search
    â†“
Click conversation
    â†“
View messages inline
    â†“
Can reply (future enhancement)
    â†“
Update status/priority
    â†“
Save changes
```

## ğŸ¨ Color Scheme

```css
/* Primary Colors */
Primary Color:     #008B8B  /* Teal/Dark Cyan */
Success (Online):  #4CAF50  /* Green */
Warning:           #FFC107  /* Amber */
Danger:            #FF4444  /* Red */
Info:              #2196F3  /* Blue */

/* Status Colors */
Open:              #28A745  /* Green */
Pending:           #FFC107  /* Yellow */
Resolved:          #17A2B8  /* Cyan */
Closed:            #6C757D  /* Gray */

/* Priority Colors */
Low:               #6C757D  /* Gray */
Normal:            #007BFF  /* Blue */
High:              #FFC107  /* Orange */
Urgent:            #DC3545  /* Red */

/* UI Elements */
Background:        #F5F5F5  /* Light Gray */
White:             #FFFFFF
Text:              #333333
Border:            #E0E0E0
Shadow:            rgba(0,0,0,0.15)
```

## ğŸ“± Responsive Breakpoints

```css
/* Desktop */
@media (min-width: 481px) {
  .chat-window {
    width: 380px;
    height: 600px;
    border-radius: 12px;
  }
}

/* Mobile */
@media (max-width: 480px) {
  .chat-window {
    width: 100vw;
    height: 100vh;
    border-radius: 0;
  }
}
```

## ğŸ”Œ API Endpoints

```
PUBLIC:
GET  /support/api/config/
     â†’ Returns widget configuration

AUTHENTICATED:
GET  /support/api/conversation/create/
     â†’ Get or create active conversation
     â†’ Returns: conversation_id, status, agent info

GET  /support/api/conversation/{id}/messages/
     â†’ Get all messages in conversation
     â†’ Returns: array of message objects

POST /support/api/conversation/{id}/send/
     â†’ Send text message
     â†’ Body: { "content": "message text" }
     â†’ Returns: message object

POST /support/api/conversation/{id}/upload/
     â†’ Upload file attachment
     â†’ Body: FormData with 'file'
     â†’ Returns: message object with attachment

POST /support/api/conversation/{id}/close/
     â†’ Close conversation
     â†’ Returns: success status

PAGES:
GET  /support/conversations/
     â†’ List all user's conversations

GET  /support/conversation/{id}/
     â†’ View conversation detail page
```

## ğŸ¯ User Journey Map

```
CUSTOMER:
Homepage â†’ See chat button â†’ Click button
    â†“
Chat opens â†’ Welcome message appears
    â†“
Type message â†’ Press Enter â†’ Message sent
    â†“
Wait for agent reply â†’ Polls every 3s
    â†“
Agent replies â†’ Message appears â†’ Continue chat
    â†“
Upload file (optional) â†’ Send emoji (optional)
    â†“
Problem solved â†’ Close chat â†’ Can reopen later
    â†“
View history: Profile â†’ Support Conversations

AGENT:
Login to admin â†’ Navigate to Support
    â†“
Set status to "Online"
    â†“
View Conversations list â†’ See new conversation
    â†“
Click conversation â†’ Read messages
    â†“
Reply to customer â†’ Update status
    â†“
Mark as Resolved â†’ Close when done
    â†“
Set status to "Offline" â†’ End shift
```

## ğŸª Feature Matrix

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Feature             â”‚ Customer â”‚ Agent    â”‚ Admin    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Send Messages       â”‚    âœ…    â”‚    âŒ*   â”‚    âœ…    â”‚
â”‚ Receive Messages    â”‚    âœ…    â”‚    âŒ*   â”‚    âœ…    â”‚
â”‚ Upload Files        â”‚    âœ…    â”‚    âŒ*   â”‚    âœ…    â”‚
â”‚ Send Emojis         â”‚    âœ…    â”‚    âŒ*   â”‚    âŒ    â”‚
â”‚ View History        â”‚    âœ…    â”‚    âœ…    â”‚    âœ…    â”‚
â”‚ Search Convos       â”‚    âŒ    â”‚    âœ…    â”‚    âœ…    â”‚
â”‚ Change Status       â”‚    âŒ    â”‚    âœ…    â”‚    âœ…    â”‚
â”‚ Set Priority        â”‚    âŒ    â”‚    âœ…    â”‚    âœ…    â”‚
â”‚ Assign Agent        â”‚    âŒ    â”‚    âœ…    â”‚    âœ…    â”‚
â”‚ Bulk Actions        â”‚    âŒ    â”‚    âœ…    â”‚    âœ…    â”‚
â”‚ Quick Replies       â”‚    âŒ    â”‚    âœ…    â”‚    âœ…    â”‚
â”‚ View Statistics     â”‚    âŒ    â”‚    âœ…    â”‚    âœ…    â”‚
â”‚ Configure Settings  â”‚    âŒ    â”‚    âŒ    â”‚    âœ…    â”‚
â”‚ Manage Agents       â”‚    âŒ    â”‚    âŒ    â”‚    âœ…    â”‚
â”‚ View All Convos     â”‚    âŒ    â”‚    âœ…    â”‚    âœ…    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

* Agent live chat reply requires WebSocket (future enhancement)
```

## ğŸ“Š Initial Data

```
SUPPORT AGENTS: 1
â””â”€â”€ admin
    â”œâ”€â”€ Display Name: admin
    â”œâ”€â”€ Display Name BN: à¦°à¦•à¦®à¦¾à¦°à¦¿
    â”œâ”€â”€ Email: (from user account)
    â”œâ”€â”€ Is Online: âŒ (SET THIS TO âœ…)
    â”œâ”€â”€ Avatar: (none - upload one)
    â””â”€â”€ Order: 1

QUICK REPLIES: 5
â”œâ”€â”€ 1. Shipping Info
â”œâ”€â”€ 2. Payment Methods
â”œâ”€â”€ 3. Return Policy
â”œâ”€â”€ 4. Track Order
â””â”€â”€ 5. Book Rental

CHAT SETTINGS: 1
â”œâ”€â”€ Enabled: âœ…
â”œâ”€â”€ Position: Bottom Right
â”œâ”€â”€ Color: #008B8B
â”œâ”€â”€ Auto Assign: âœ…
â”œâ”€â”€ Max File Size: 5 MB
â”œâ”€â”€ Show Online Status: âœ…
â””â”€â”€ Welcome Message: Set (EN & BN)
```

## âœ… Installation Checklist

```
âœ… Django app 'support' created
âœ… Models defined (5 models)
âœ… Migrations created and applied
âœ… Admin interface configured
âœ… Views implemented (9 views)
âœ… URLs configured
âœ… Templates created (2 templates)
âœ… Static files added (CSS + JS)
âœ… Base template updated
âœ… Settings.py updated
âœ… Initial data loaded
âœ… Documentation created (3 files)
âœ… Development server running
```

## ğŸ¬ What Happens When...

### User Opens Chat:
1. Widget loads configuration from API
2. Checks if user is logged in
3. Creates/retrieves conversation
4. Auto-assigns to online agent
5. Loads message history
6. Displays welcome message
7. Starts polling for new messages (3s)
8. Shows online/offline status

### User Sends Message:
1. User types in input field
2. Presses Enter or clicks send
3. JavaScript validates message
4. Sends AJAX POST request
5. Server creates Message object
6. Updates conversation timestamp
7. Increments agent unread count
8. Returns success response
9. UI updates immediately
10. Clears input field

### Agent Goes Online:
1. Admin logs into panel
2. Navigates to Support Agents
3. Edits their profile
4. Checks "Is online" box
5. Saves changes
6. Widget shows "online" status
7. New conversations auto-assign
8. Welcome message sent to customers

### File Upload:
1. User clicks paperclip icon
2. File picker opens
3. User selects file
4. JavaScript validates size (<5MB)
5. Creates FormData object
6. Sends AJAX POST with file
7. Server saves to media/support/attachments
8. Creates Message with attachment
9. Returns attachment URL
10. UI shows preview/download link

---

**ğŸ‰ Your support chat system is complete and ready!**

Just set the agent to "Online" and start chatting! ğŸ’¬
