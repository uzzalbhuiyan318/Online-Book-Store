{% extends 'admin_panel/base.html' %}
{% load static %}

{% block title %}{% if form.instance.pk %}Edit{% else %}Add{% endif %} Coupon - Admin Panel{% endblock %}
{% block page_title %}{% if form.instance.pk %}Edit Coupon{% else %}Add New Coupon{% endif %}{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="admin-card">
            <div class="admin-card-header">
                <h5><i class="fas fa-ticket-alt"></i> Coupon Information</h5>
            </div>
            <div class="admin-card-body">
                <form method="post">
                    {% csrf_token %}
                    
                    <div class="admin-form-group">
                        <label for="{{ form.code.id_for_label }}" class="form-label">
                            Coupon Code <span class="text-danger">*</span>
                        </label>
                        {{ form.code }}
                        {% if form.code.errors %}
                        <div class="invalid-feedback d-block">{{ form.code.errors }}</div>
                        {% endif %}
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="admin-form-group">
                                <label for="{{ form.discount_type.id_for_label }}" class="form-label">
                                    Discount Type <span class="text-danger">*</span>
                                </label>
                                {{ form.discount_type }}
                                {% if form.discount_type.errors %}
                                <div class="invalid-feedback d-block">{{ form.discount_type.errors }}</div>
                                {% endif %}
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="admin-form-group">
                                <label for="{{ form.discount_value.id_for_label }}" class="form-label">
                                    Discount Value <span class="text-danger">*</span>
                                </label>
                                {{ form.discount_value }}
                                {% if form.discount_value.errors %}
                                <div class="invalid-feedback d-block">{{ form.discount_value.errors }}</div>
                                {% endif %}
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="admin-form-group">
                                <label for="{{ form.valid_from.id_for_label }}" class="form-label">
                                    Valid From <span class="text-danger">*</span>
                                </label>
                                {{ form.valid_from }}
                                {% if form.valid_from.errors %}
                                <div class="invalid-feedback d-block">{{ form.valid_from.errors }}</div>
                                {% endif %}
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="admin-form-group">
                                <label for="{{ form.valid_to.id_for_label }}" class="form-label">
                                    Valid Until <span class="text-danger">*</span>
                                </label>
                                {{ form.valid_to }}
                                {% if form.valid_to.errors %}
                                <div class="invalid-feedback d-block">{{ form.valid_to.errors }}</div>
                                {% endif %}
                            </div>
                        </div>
                    </div>

                    <div class="admin-form-group">
                        <label for="{{ form.description.id_for_label }}" class="form-label">Description</label>
                        {{ form.description }}
                        {% if form.description.errors %}
                        <div class="invalid-feedback d-block">{{ form.description.errors }}</div>
                        {% endif %}
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="admin-form-group">
                                <label for="{{ form.min_purchase_amount.id_for_label }}" class="form-label">Min Purchase Amount</label>
                                {{ form.min_purchase_amount }}
                                {% if form.min_purchase_amount.errors %}
                                <div class="invalid-feedback d-block">{{ form.min_purchase_amount.errors }}</div>
                                {% endif %}
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="admin-form-group">
                                <label for="{{ form.max_discount_amount.id_for_label }}" class="form-label">Max Discount Amount</label>
                                {{ form.max_discount_amount }}
                                <small class="text-muted">For percentage discounts</small>
                                {% if form.max_discount_amount.errors %}
                                <div class="invalid-feedback d-block">{{ form.max_discount_amount.errors }}</div>
                                {% endif %}
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="admin-form-group">
                                <label for="{{ form.max_uses.id_for_label }}" class="form-label">Max Total Uses</label>
                                {{ form.max_uses }}
                                <small class="text-muted">Leave empty for unlimited</small>
                                {% if form.max_uses.errors %}
                                <div class="invalid-feedback d-block">{{ form.max_uses.errors }}</div>
                                {% endif %}
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="admin-form-group">
                                <label for="{{ form.max_uses_per_user.id_for_label }}" class="form-label">Max Uses Per User</label>
                                {{ form.max_uses_per_user }}
                                {% if form.max_uses_per_user.errors %}
                                <div class="invalid-feedback d-block">{{ form.max_uses_per_user.errors }}</div>
                                {% endif %}
                            </div>
                        </div>
                    </div>

                    <div class="admin-form-group">
                        <div class="form-check">
                            {{ form.is_active }}
                            <label class="form-check-label" for="{{ form.is_active.id_for_label }}">
                                Active
                            </label>
                        </div>
                    </div>

                    <div class="admin-form-group mb-0">
                        <button type="submit" class="btn btn-admin-primary">
                            <i class="fas fa-save"></i> Save Coupon
                        </button>
                        <a href="{% url 'admin_panel:coupon_list' %}" class="btn btn-admin-secondary">
                            <i class="fas fa-times"></i> Cancel
                        </a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}
