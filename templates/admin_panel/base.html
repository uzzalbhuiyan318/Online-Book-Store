{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Admin Panel{% endblock %} - BookStore</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Custom Admin CSS -->
    <link rel="stylesheet" href="{% static 'css/admin-panel.css' %}">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    {% block extra_css %}{% endblock %}
</head>
<body>
    <div class="admin-wrapper">
        <!-- Sidebar -->
        <aside class="admin-sidebar" id="adminSidebar">
            <div class="admin-sidebar-header">
                <h3><i class="fas fa-book"></i> BookStore</h3>
                <p>Admin Panel</p>
            </div>
            
            <nav class="admin-nav">
                <!-- Dashboard -->
                <div class="admin-nav-section">
                    <a href="{% url 'admin_panel:dashboard' %}" class="admin-nav-item {% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Dashboard</span>
                    </a>
                </div>
                
                <!-- Products -->
                <div class="admin-nav-section">
                    <div class="admin-nav-section-title">Products</div>
                    <a href="{% url 'admin_panel:book_list' %}" class="admin-nav-item {% if 'book' in request.path %}active{% endif %}">
                        <i class="fas fa-book"></i>
                        <span>Books</span>
                    </a>
                    <a href="{% url 'admin_panel:category_list' %}" class="admin-nav-item {% if 'categor' in request.path %}active{% endif %}">
                        <i class="fas fa-tags"></i>
                        <span>Categories</span>
                    </a>
                    <a href="{% url 'admin_panel:banner_list' %}" class="admin-nav-item {% if 'banner' in request.path %}active{% endif %}">
                        <i class="fas fa-image"></i>
                        <span>Banners</span>
                    </a>
                </div>
                
                <!-- Sales -->
                <div class="admin-nav-section">
                    <div class="admin-nav-section-title">Sales</div>
                    <a href="{% url 'admin_panel:order_list' %}" class="admin-nav-item {% if 'order' in request.path and 'gift' not in request.path %}active{% endif %}">
                        <i class="fas fa-shopping-cart"></i>
                        <span>Orders</span>
                        {% if pending_orders %}
                        <span class="badge">{{ pending_orders }}</span>
                        {% endif %}
                    </a>
                    <a href="{% url 'admin_panel:coupon_list' %}" class="admin-nav-item {% if 'coupon' in request.path %}active{% endif %}">
                        <i class="fas fa-ticket-alt"></i>
                        <span>Coupons</span>
                    </a>
                    <a href="{% url 'admin_panel:shipping_fee_list' %}" class="admin-nav-item {% if 'shipping-fee' in request.path %}active{% endif %}">
                        <i class="fas fa-shipping-fast"></i>
                        <span>Shipping Fees</span>
                    </a>
                </div>
                
                <!-- Rentals -->
                <div class="admin-nav-section">
                    <div class="admin-nav-section-title">Rentals</div>
                    <a href="{% url 'admin_panel:rental_list' %}" class="admin-nav-item {% if 'rental' in request.path and 'plan' not in request.path and 'feedback' not in request.path and 'notification' not in request.path %}active{% endif %}">
                        <i class="fas fa-calendar-alt"></i>
                        <span>Rentals</span>
                        {% if overdue_rentals %}
                        <span class="badge bg-danger">{{ overdue_rentals }}</span>
                        {% endif %}
                    </a>
                    <a href="{% url 'admin_panel:rental_plan_list' %}" class="admin-nav-item {% if 'plan' in request.path %}active{% endif %}">
                        <i class="fas fa-list"></i>
                        <span>Rental Plans</span>
                    </a>
                    <a href="{% url 'admin_panel:rental_feedback_list' %}" class="admin-nav-item {% if 'feedback' in request.path %}active{% endif %}">
                        <i class="fas fa-comment-dots"></i>
                        <span>Feedback</span>
                    </a>
                    <a href="{% url 'admin_panel:rental_notification_list' %}" class="admin-nav-item {% if 'notification' in request.path %}active{% endif %}">
                        <i class="fas fa-bell"></i>
                        <span>Notifications</span>
                    </a>
                    <a href="{% url 'admin_panel:rental_settings' %}" class="admin-nav-item {% if 'settings' in request.path %}active{% endif %}">
                        <i class="fas fa-cog"></i>
                        <span>Settings</span>
                    </a>
                </div>
                
                <!-- Gifts -->
                <div class="admin-nav-section">
                    <div class="admin-nav-section-title">Gifts</div>
                    <a href="{% url 'admin_panel:gift_form_list' %}" class="admin-nav-item {% if 'gift' in request.path and 'cit' not in request.path and 'area' not in request.path and 'zone' not in request.path and 'occasion' not in request.path %}active{% endif %}">
                        <i class="fas fa-gift"></i>
                        <span>Gift Orders</span>
                    </a>
                    <a href="{% url 'admin_panel:gift_city_list' %}" class="admin-nav-item {% if 'cit' in request.path %}active{% endif %}">
                        <i class="fas fa-city"></i>
                        <span>Cities</span>
                    </a>
                    <a href="{% url 'admin_panel:gift_area_list' %}" class="admin-nav-item {% if 'area' in request.path %}active{% endif %}">
                        <i class="fas fa-map-marked-alt"></i>
                        <span>Areas</span>
                    </a>
                    <a href="{% url 'admin_panel:gift_zone_list' %}" class="admin-nav-item {% if 'zone' in request.path %}active{% endif %}">
                        <i class="fas fa-map-marker-alt"></i>
                        <span>Zones</span>
                    </a>
                    <a href="{% url 'admin_panel:gift_occasion_list' %}" class="admin-nav-item {% if 'occasion' in request.path %}active{% endif %}">
                        <i class="fas fa-calendar-day"></i>
                        <span>Occasions</span>
                    </a>
                </div>
                
                <!-- Customers -->
                <div class="admin-nav-section">
                    <div class="admin-nav-section-title">Customers</div>
                    <a href="{% url 'admin_panel:customer_list' %}" class="admin-nav-item {% if 'customer' in request.path %}active{% endif %}">
                        <i class="fas fa-users"></i>
                        <span>Customers</span>
                    </a>
                    <a href="{% url 'admin_panel:review_list' %}" class="admin-nav-item {% if 'review' in request.path %}active{% endif %}">
                        <i class="fas fa-star"></i>
                        <span>Reviews</span>
                        {% if pending_reviews %}
                        <span class="badge">{{ pending_reviews }}</span>
                        {% endif %}
                    </a>
                </div>
                
                <!-- Support -->
                <div class="admin-nav-section">
                    <div class="admin-nav-section-title">Support</div>
                    <a href="{% url 'admin_panel:support_conversation_list' %}" class="admin-nav-item {% if 'conversation' in request.path %}active{% endif %}">
                        <i class="fas fa-comments"></i>
                        <span>Conversations</span>
                    </a>
                    <a href="{% url 'admin_panel:support_agent_list' %}" class="admin-nav-item {% if 'agent' in request.path %}active{% endif %}">
                        <i class="fas fa-user-tie"></i>
                        <span>Agents</span>
                    </a>
                    <a href="{% url 'admin_panel:quick_reply_list' %}" class="admin-nav-item {% if 'quick-reply' in request.path %}active{% endif %}">
                        <i class="fas fa-reply"></i>
                        <span>Quick Replies</span>
                    </a>
                    <a href="{% url 'admin_panel:chat_settings' %}" class="admin-nav-item {% if 'chat-settings' in request.path %}active{% endif %}">
                        <i class="fas fa-cog"></i>
                        <span>Chat Settings</span>
                    </a>
                </div>
                
                <!-- Reports -->
                <div class="admin-nav-section">
                    <div class="admin-nav-section-title">Reports</div>
                    <a href="{% url 'admin_panel:sales_report' %}" class="admin-nav-item {% if 'sales' in request.path %}active{% endif %}">
                        <i class="fas fa-chart-line"></i>
                        <span>Sales Report</span>
                    </a>
                    <a href="{% url 'admin_panel:customer_report' %}" class="admin-nav-item {% if 'customer' in request.path and 'report' in request.path %}active{% endif %}">
                        <i class="fas fa-users"></i>
                        <span>Customer Report</span>
                    </a>
                    <a href="{% url 'admin_panel:inventory_report' %}" class="admin-nav-item {% if 'inventory' in request.path %}active{% endif %}">
                        <i class="fas fa-boxes"></i>
                        <span>Inventory Report</span>
                    </a>
                </div>
                
                <!-- System -->
                <div class="admin-nav-section">
                    <div class="admin-nav-section-title">System</div>
                    <a href="/admin/" class="admin-nav-item" target="_blank">
                        <i class="fas fa-cogs"></i>
                        <span>Django Admin</span>
                        <i class="fas fa-external-link-alt ms-auto"></i>
                    </a>
                    <a href="{% url 'books:home' %}" class="admin-nav-item">
                        <i class="fas fa-home"></i>
                        <span>View Site</span>
                        <i class="fas fa-external-link-alt ms-auto"></i>
                    </a>
                </div>
            </nav>
        </aside>
        
        <!-- Main Content -->
        <main class="admin-main">
            <!-- Header -->
            <header class="admin-header">
                <div class="admin-header-content">
                    <div class="admin-header-title">
                        <button class="admin-mobile-toggle" onclick="toggleSidebar()">
                            <i class="fas fa-bars"></i>
                        </button>
                        <h1>{% block page_title %}Dashboard{% endblock %}</h1>
                        <nav class="admin-breadcrumb" aria-label="breadcrumb">
                            <ol class="breadcrumb">
                                <li class="breadcrumb-item"><a href="{% url 'admin_panel:dashboard' %}">Home</a></li>
                                {% block breadcrumbs %}{% endblock %}
                            </ol>
                        </nav>
                    </div>
                    
                    <div class="admin-header-actions">
                        <div class="admin-header-user">
                            <div class="admin-user-avatar">
                                {{ request.user.email|slice:":1"|upper }}
                            </div>
                            <div class="admin-user-info">
                                <div class="admin-user-name">{{ request.user.full_name|default:request.user.email }}</div>
                                <div class="admin-user-role">Administrator</div>
                            </div>
                        </div>
                        <a href="{% url 'accounts:logout' %}" class="btn btn-outline-danger btn-sm">
                            <i class="fas fa-sign-out-alt"></i> Logout
                        </a>
                    </div>
                </div>
            </header>
            
            <!-- Content -->
            <div class="admin-content">
                <!-- Messages -->
                {% if messages %}
                <div class="admin-messages">
                    {% for message in messages %}
                    <div class="admin-alert admin-alert-{{ message.tags }}">
                        <i class="fas fa-{% if message.tags == 'success' %}check-circle{% elif message.tags == 'error' %}exclamation-circle{% elif message.tags == 'warning' %}exclamation-triangle{% else %}info-circle{% endif %}"></i>
                        {{ message }}
                    </div>
                    {% endfor %}
                </div>
                {% endif %}
                
                {% block content %}{% endblock %}
            </div>
        </main>
    </div>
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    
    <!-- Custom Admin JS -->
    <script>
        function toggleSidebar() {
            document.getElementById('adminSidebar').classList.toggle('show');
        }
        
        // Auto-hide messages after 5 seconds
        setTimeout(function() {
            $('.admin-alert').fadeOut('slow');
        }, 5000);
        
        // Confirm delete actions
        $('[data-confirm]').on('click', function(e) {
            if (!confirm($(this).data('confirm'))) {
                e.preventDefault();
            }
        });
        
        // Select all checkboxes
        $('#selectAll').on('change', function() {
            $('.item-checkbox').prop('checked', this.checked);
        });
    </script>
    
    {% block extra_js %}{% endblock %}
</body>
</html>
